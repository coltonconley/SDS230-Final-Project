BE$rother <- (BE$Other+BE$Trans+BE$Whlsl+BE$Boxes+BE$Guns+BE$Agric+BE$Paper+BE$Util)/8
knitr::opts_chunk$set(echo = TRUE)
BE <- read.csv("Average BE .csv")
View(BE)
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
View(BE)
View(BE)
View(returns)
size$Year <- substr(size$Year, 1, 4)
View(size)
unique(table(size$Year))
(table(size$Year))
returns$Year <- substr(size$Year, 1, 4)
returns$Year <- substr(return$Year, 1, 4)
View(returns)
as.integer(returns$Year)
returns$Year <- substr(return$Year, 1, 4)
View(returns)
returns$Year <- substr(return$Year, 1, 4)
as.character(returns$Year)
returns$Year <- substr(return$Year, 1, 4)
returns$Year <- as.character(returns$Year)
returns$Year <- substr(return$Year, 1, 4)
str(returns)
returns$Year <- substr(return$Year, 1, 4)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
returns$Year <- substr(return$Year, 1, 4)
View(size)
aggregate(.~Year, data = size, mean)
View(size)
size <- aggregate(.~Year, data = size, mean)
View(BE)
View(size)
?merge
df <- merge3(BE, size, by = Year)
df <- merge(BE, size, by = Year)
df <- merge(BE, size, by = "Year")
View(df)
knitr::opts_chunk$set(echo = TRUE)
getwd()
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(return$Year, 1, 4) #Ask what is going on here
View(BE)
?melt
install.packages("reshape")
library(reshape)
a <- melt(BE, id = c("Year"))
View(a)
BE <- melt(BE, id = c("Year"))
BE$YearInd <-
BE$BEMERatio <- BE$value
BE$value <- NULL
BE$Ind <- BE$variable
BE$variable <- NULL
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(return$Year, 1, 4) #Ask what is going on here
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
#returns$Year <- substr(return$Year, 1, 4) #Ask what is going on here
# separate year from month in "size" dataframe
#size$Year2 <- substr(size$Year, 1, 4)
#size$Month <- substr(size$Year, 5, 6)
# separate year from month in "returns" dataframe
#returns$Year2 <- substr(size$Year, 1, 4)
#returns$Month <- substr(size$Year, 5, 6)
# make an average by year for "size" dataframe
#table(size[size$Year2 == "1926",])
#apply(size[size$Year2 == "1926",], 2, mean)
#size[size$Year2 == "1926",]
#data.frame(size[], apply(size[,c(2:50)],2, mean) )
#table(size$Year2)
BE <- melt(BE, id = c("Year"))
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
size <- melt(size, id = c("Year"))
View(size)
size$value <- size$size
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
#returns$Year <- substr(return$Year, 1, 4) #Ask what is going on here
# separate year from month in "size" dataframe
#size$Year2 <- substr(size$Year, 1, 4)
#size$Month <- substr(size$Year, 5, 6)
# separate year from month in "returns" dataframe
#returns$Year2 <- substr(size$Year, 1, 4)
#returns$Month <- substr(size$Year, 5, 6)
# make an average by year for "size" dataframe
#table(size[size$Year2 == "1926",])
#apply(size[size$Year2 == "1926",], 2, mean)
#size[size$Year2 == "1926",]
#data.frame(size[], apply(size[,c(2:50)],2, mean) )
#table(size$Year2)
BE <- melt(BE, id = c("Year"))
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
size <- melt(size, id = c("Year"))
size$size <- size$value
size$value <- NULL
size$Ind <- size$variable
size$variable <- NULL
View(size)
size$YearInd <- paste(size$Year, size$Ind, sep = "_")
BE$YearInd <- paste(BE$Year, BE$Ind, sep = "_")
df <- merge(BE, size, by = "YearInd")
View(df)
df$YearInd <- NULL
df$Year.y <- NULL
df$Ind.y <- NULL
names(df)[1:2] <- c("Year", "Ind")
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- NA
size[size == -99.99] <- NA
returns[returns == -99.99] <- NA
View(BE)
View(returns)
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
View(size)
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
View(size)
returns$Year <- substr(return$Year, 1, 4) #Ask what is going on here
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(returns$Year, 1, 4) #Ask what is going on here
# separate year from month in "size" dataframe
#size$Year2 <- substr(size$Year, 1, 4)
#size$Month <- substr(size$Year, 5, 6)
# separate year from month in "returns" dataframe
#returns$Year2 <- substr(size$Year, 1, 4)
#returns$Month <- substr(size$Year, 5, 6)
# make an average by year for "size" dataframe
#table(size[size$Year2 == "1926",])
#apply(size[size$Year2 == "1926",], 2, mean)
#size[size$Year2 == "1926",]
#data.frame(size[], apply(size[,c(2:50)],2, mean) )
#table(size$Year2)
returns <- aggregate(.~Year, data = returns, mean)
View(returns)
View(returns)
View(BE)
BE <- melt(BE, id = c("Year"))
View(BE)
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
View(BE)
size <- melt(size, id = c("Year"))
size$size <- size$value
size$value <- NULL
size$Ind <- size$variable
size$variable <- NULL
size$YearInd <- paste(size$Year, size$Ind, sep = "_")
BE$YearInd <- paste(BE$Year, BE$Ind, sep = "_")
df <- merge(BE, size, by = "YearInd")
View(df)
df$YearInd <- NULL
df$Year.y <- NULL
df$Ind.y <- NULL
names(df)[1:2] <- c("Year", "Ind")
View(df)
library(reshape)
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(returns$Year, 1, 4) #Ask what is going on here
returns <- aggregate(.~Year, data = returns, mean)
#Kick off the last row so that we have same sized datasets.
BE <- BE[1:89,]
size <- size[1:89,]
returns <- melt(returns, id = c("Returns"))
returns <- melt(returns, id = c("Year"))
View(returns)
returns$returns <- returns$value
returns$value <- NULL
returns$Ind <- returns$variable
size$variable <- NULL
View(returns)
BE <- melt(BE, id = c("Year"))
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
size <- melt(size, id = c("Year"))
size$size <- size$value
size$value <- NULL
size$Ind <- size$variable
size$variable <- NULL
df <- merge(c(size, BE, returns), by = "YearInd")
df <- merge(size, BE, by = "YearInd")
size$YearInd <- paste(size$Year, size$Ind, sep = "_")
BE$YearInd <- paste(BE$Year, BE$Ind, sep = "_")
returns$YearInd <- paste(returns$Year, BE$Ind, sep = "_")
df <- merge(size, BE, by = "YearInd")
df <- merge(df, returns, by = "YearInd")
View(df)
df$YearInd <- NULL
df$Year.y <- NULL
df$Ind.y <- NULL
df$variable <- NULL
df$Year <- NULL
df$Ind.x <- NULL
names(df)[1] <- "Year"
df$CompInd <- recode(df$Ind, "'Hlth' = 'Healthcare'; 'MedEq' = 'Healthcare'; 'Drugs' = 'Healthcare'; 'Chems' = 'Healthcare'; 'LabEq' = 'Healthcare'; 'Rubbr' = 'Industrials'; 'BldMt = 'Industrials'; 'Cnstr' = 'Industrials'; 'Mach' = 'Industrials'; 'ElcEq' = 'Industrials'; 'Autos' = 'Industrials'; 'Aero' = 'Industrials'; 'Ships' = 'Industrials'; 'Mines' = 'Industrials'; 'FabPr' = 'Industrials'; 'Fun' = 'TMT'; 'Telcm' = 'TMT'; 'PerSv' = 'TMT'; 'BusSv' = 'TMT'; 'Softw' = 'TMT'; 'Chips' = 'TMT'; 'Paper' = 'TMT'; 'Banks' = 'Financials'; 'Insur' = 'Financials'; 'RlEst' = 'Financials'; 'Fin' = 'Financials'; 'Food' = 'Consumer'; 'Soda' = 'Consumer'; 'Beer' = 'Consumer'; 'Smoke' = 'Consumer'; 'Books' = 'Consumer'; 'Clths' = 'Consumer'; 'Hshld' = 'Consumer'; 'Meals' = 'Consumer'; 'Rtail' = 'Consumer'; 'Util' = 'Utilities'; 'Gold' = 'Commondities'; 'Coal' = 'Commondities'; 'Oil' = 'Commondities'; 'Steel' = 'Commondities'; 'Txtls' = 'Commondities'; 'Other' = 'Other'; 'Trans' = 'Other'; 'Boxes' = 'Other'; 'Guns' = 'Other'; 'Whlsl' = 'Other'; 'Agric' = 'Other'; 'Toys' = 'Other'")
library(car)
knitr::opts_chunk$set(echo = TRUE)
CompInd
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
library(car)
library(leaps)
library(lubridate)
library(rvest)
library(olsrr)
library(corrplot)
library(leaps)
library(car)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
rf <- read.csv("RP-RF.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
rf[rf == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(returns$Year, 1, 4) #Ask what is going on here
returns <- aggregate(.~Year, data = returns, mean)
rf$Year <- substr(rf$Year,1,4)
rf <- aggregate(.~Year, data= rf, mean)
rf$mktret <- rf$Mkt.RF+rf$RF #This creates the column for market return - done by adding back the risk free rate to the risk free market return
#Kick off the last row so that we have same sized datasets.
BE <- BE[1:89,]
size <- size[1:89,]
rf <- rf[1:89,]
# separate year from month in "size" dataframe
#size$Year2 <- substr(size$Year, 1, 4)
#size$Month <- substr(size$Year, 5, 6)
# separate year from month in "returns" dataframe
#returns$Year2 <- substr(size$Year, 1, 4)
#returns$Month <- substr(size$Year, 5, 6)
# make an average by year for "size" dataframe
#table(size[size$Year2 == "1926",])
#apply(size[size$Year2 == "1926",], 2, mean)
#size[size$Year2 == "1926",]
#data.frame(size[], apply(size[,c(2:50)],2, mean) )
#table(size$Year2)
BE <- melt(BE, id = c("Year"))
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
size <- melt(size, id = c("Year"))
size$size <- size$value
size$value <- NULL
size$Ind <- size$variable
size$variable <- NULL
returns <- melt(returns, id = c("Year"))
returns$returns <- returns$value
returns$value <- NULL
returns$Ind <- returns$variable
size$variable <- NULL
size$YearInd <- paste(size$Year, size$Ind, sep = "_")
BE$YearInd <- paste(BE$Year, BE$Ind, sep = "_")
returns$YearInd <- paste(returns$Year, BE$Ind, sep = "_")
df <- merge(size, BE, by = "YearInd")
df <- merge(df, returns, by = "YearInd")
df$YearInd <- NULL
df$Year.y <- NULL
df$Ind.y <- NULL
df$variable <- NULL
df$Year <- NULL
df$Ind.x <- NULL
names(df)[1] <- "Year"
df$CompInd <- recode(df$Ind, "'Hlth' = 'Healthcare'; 'MedEq' = 'Healthcare'; 'Drugs' = 'Healthcare'; 'Chems' = 'Healthcare'; 'LabEq' = 'Healthcare'; 'Rubbr' = 'Industrials'; 'BldMt' = 'Industrials'; 'Cnstr' = 'Industrials'; 'Mach' = 'Industrials'; 'ElcEq' = 'Industrials'; 'Autos' = 'Industrials'; 'Aero' = 'Industrials'; 'Ships' = 'Industrials'; 'Mines' = 'Industrials'; 'FabPr' = 'Industrials'; 'Fun' = 'TMT'; 'Telcm' = 'TMT'; 'PerSv' = 'TMT'; 'BusSv' = 'TMT'; 'Softw' = 'TMT'; 'Chips' = 'TMT'; 'Paper' = 'TMT';'Hardw' = 'TMT'; 'Banks' = 'Financials'; 'Insur' = 'Financials'; 'RlEst' = 'Financials'; 'Fin' = 'Financials'; 'Food' = 'Consumer'; 'Soda' = 'Consumer'; 'Beer' = 'Consumer'; 'Smoke' = 'Consumer'; 'Books' = 'Consumer'; 'Clths' = 'Consumer'; 'Hshld' = 'Consumer'; 'Meals' = 'Consumer'; 'Rtail' = 'Consumer'; 'Util' = 'Utilities'; 'Gold' = 'Commodities'; 'Coal' = 'Commodities'; 'Oil' = 'Commodities'; 'Steel' = 'Commodities'; 'Txtls' = 'Commodities'; 'Other' = 'Other'; 'Trans' = 'Other'; 'Boxes' = 'Other'; 'Guns' = 'Other'; 'Whlsl' = 'Other'; 'Agric' = 'Other'; 'Toys' = 'Other'")
df <- merge(df, rf, by = "Year")
df$Year <- as.factor(df$Year)
df$Beta <- NA
for(i in unique(df$Ind)){
temp <- df[df$Ind == i,]
a <- (cov(temp$returns,temp$mktret))/(var(temp$mktret))
df$Beta[df$Ind==i] <- a
}
CompInd
df$CompInd
df %in% df$CompInd
Inudstrials %in% df$CompInd
'Industrials' %in% df$CompInd
df['Industrials' %in% df$CompInd,]
knitr::opts_chunk$set(echo = TRUE)
library(reshape)
library(car)
library(leaps)
library(lubridate)
library(rvest)
library(olsrr)
library(corrplot)
library(leaps)
library(car)
source("http://www.reuningscherer.net/s&ds230/Rfuncs/regJDRS.txt")
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
rf <- read.csv("RP-RF.csv")
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0
size[size == -99.99] <- 0
returns[returns == -99.99] <- 0
rf[rf == -99.99] <- 0
size$Year <- substr(size$Year, 1, 4) #Strip off all ofthe month values
size <- aggregate(.~Year, data = size, mean)
returns$Year <- substr(returns$Year, 1, 4) #Ask what is going on here
returns <- aggregate(.~Year, data = returns, mean)
rf$Year <- substr(rf$Year,1,4)
rf <- aggregate(.~Year, data= rf, mean)
rf$mktret <- rf$Mkt.RF+rf$RF #This creates the column for market return - done by adding back the risk free rate to the risk free market return
#Kick off the last row so that we have same sized datasets.
BE <- BE[1:89,]
size <- size[1:89,]
rf <- rf[1:89,]
# separate year from month in "size" dataframe
#size$Year2 <- substr(size$Year, 1, 4)
#size$Month <- substr(size$Year, 5, 6)
# separate year from month in "returns" dataframe
#returns$Year2 <- substr(size$Year, 1, 4)
#returns$Month <- substr(size$Year, 5, 6)
# make an average by year for "size" dataframe
#table(size[size$Year2 == "1926",])
#apply(size[size$Year2 == "1926",], 2, mean)
#size[size$Year2 == "1926",]
#data.frame(size[], apply(size[,c(2:50)],2, mean) )
#table(size$Year2)
BE <- melt(BE, id = c("Year"))
BE$Ind <- BE$variable
BE$variable <- NULL
BE$BEMERatio <- BE$value
BE$value <- NULL
size <- melt(size, id = c("Year"))
size$size <- size$value
size$value <- NULL
size$Ind <- size$variable
size$variable <- NULL
returns <- melt(returns, id = c("Year"))
returns$returns <- returns$value
returns$value <- NULL
returns$Ind <- returns$variable
size$variable <- NULL
size$YearInd <- paste(size$Year, size$Ind, sep = "_")
BE$YearInd <- paste(BE$Year, BE$Ind, sep = "_")
returns$YearInd <- paste(returns$Year, BE$Ind, sep = "_")
df <- merge(size, BE, by = "YearInd")
df <- merge(df, returns, by = "YearInd")
df$YearInd <- NULL
df$Year.y <- NULL
df$Ind.y <- NULL
df$variable <- NULL
df$Year <- NULL
df$Ind.x <- NULL
names(df)[1] <- "Year"
df$CompInd <- recode(df$Ind, "'Hlth' = 'Healthcare'; 'MedEq' = 'Healthcare'; 'Drugs' = 'Healthcare'; 'Chems' = 'Healthcare'; 'LabEq' = 'Healthcare'; 'Rubbr' = 'Industrials'; 'BldMt' = 'Industrials'; 'Cnstr' = 'Industrials'; 'Mach' = 'Industrials'; 'ElcEq' = 'Industrials'; 'Autos' = 'Industrials'; 'Aero' = 'Industrials'; 'Ships' = 'Industrials'; 'Mines' = 'Industrials'; 'FabPr' = 'Industrials'; 'Fun' = 'TMT'; 'Telcm' = 'TMT'; 'PerSv' = 'TMT'; 'BusSv' = 'TMT'; 'Softw' = 'TMT'; 'Chips' = 'TMT'; 'Paper' = 'TMT';'Hardw' = 'TMT'; 'Banks' = 'Financials'; 'Insur' = 'Financials'; 'RlEst' = 'Financials'; 'Fin' = 'Financials'; 'Food' = 'Consumer'; 'Soda' = 'Consumer'; 'Beer' = 'Consumer'; 'Smoke' = 'Consumer'; 'Books' = 'Consumer'; 'Clths' = 'Consumer'; 'Hshld' = 'Consumer'; 'Meals' = 'Consumer'; 'Rtail' = 'Consumer'; 'Util' = 'Utilities'; 'Gold' = 'Commodities'; 'Coal' = 'Commodities'; 'Oil' = 'Commodities'; 'Steel' = 'Commodities'; 'Txtls' = 'Commodities'; 'Other' = 'Other'; 'Trans' = 'Other'; 'Boxes' = 'Other'; 'Guns' = 'Other'; 'Whlsl' = 'Other'; 'Agric' = 'Other'; 'Toys' = 'Other'")
df <- merge(df, rf, by = "Year")
df$Year <- as.factor(df$Year)
df$Beta <- NA
for(i in unique(df$Ind)){
temp <- df[df$Ind == i,]
a <- (cov(temp$returns,temp$mktret))/(var(temp$mktret))
df$Beta[df$Ind==i] <- a
}
df
plot(df$returns ~ df$Year, main = "Scatterplot of Year versus Average Yearly Returns", pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
plot(df$returns ~ df$Year, main = "Scatterplot of Year versus Average Yearly Returns", pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
plot(df$returns ~ df$Year, main = "Scatterplot of Year versus Average Yearly Returns", pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
lines(f$returns ~ df$Year)
plot(df$returns ~ df$Year, main = "Scatterplot of Year versus Average Yearly Returns", pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
lines(df$returns ~ df$Year)
plot(df$returns[df$CompInd == "Industrials"] ~ df$Year[df$CompInd == "Industrials"], pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
plot(df$returns[df$CompInd == "Industrials"] ~ df$Year[df$CompInd == "Industrials"], pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
lines(df$returns[df$CompInd == "Industrials"] ~ df$Year[df$CompInd == "Industrials"])
plot(df$returns[df$CompInd == "Industrials"] ~ df$Year[df$CompInd == "Industrials"], pch = 24, col = "blue", xlab = "Year", ylab = "Average Yearly Returns")
lines(df$CompInd[df$CompInd == "Industrials"] ~ df$Year[df$CompInd == "Industrials"])
aggregate(df$returns ~ df$CompInd + df$Year, df, mean)
df
indreturnscomp <- as.data.frame(aggregate(df$returns ~ df$CompInd + df$Year, df, mean))
indreturnscomp
merge(df, indreturnscomp, all.x=T, by = c("Year", "CompInd"))
df
indreturnscomp
indreturnscomp <- aggregate(df$returns ~ df$CompInd + df$Year, df, mean)
indreturnscomp
colnames(indreturnscomp)
indreturnscomp <- aggregate(df$returns ~ df$CompInd + df$Year, df, mean)
colnames(indreturnscomp) <- c("CompInd", "Year", "Returns")
indreturnscomp
merge(df, indreturnscomp, all.x=T, by = c("Year", "CompInd"))
indreturnscomp <- aggregate(df$returns ~ df$CompInd + df$Year, df, mean)
colnames(indreturnscomp) <- c("CompInd", "Year", "Composite Returns")
indreturnscomp
merge(df, indreturnscomp, all.x=T, by = c("Year", "CompInd"))
df
merge(df, indreturnscomp, all.x=T, by = c("Year", "CompInd"))
indreturnscomp
df
newdf <- merge(df, indreturnscomp, all.x=T, by = c("Year", "CompInd"))
newdf
indreturnscomp
