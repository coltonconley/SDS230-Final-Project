---
title: "SDS230_Final_Project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

###Introduction 
This project will examine data from Fama & French 1992 which provides information on the average firm size, monthly return, and beta (?) for 49 different industries. The questions of the project are two-fold: First, we wsih to examine how significant is each variable in predicting returns according to CAPM. Second, we wish to see if there is a difference between CAPM predictions and the actual data through various statistical comparisons including t-tests and permutation tests. 

The purpose of this project will be to examine the hypothesis of the Capital Asset Pricing Model (CAPM) which suggests that alpha (define) can not be generated in a given portfolio or industry. 

###Data
```{r}
getwd()
BE <- read.csv("Average BE .csv")
size <- read.csv("Average Firm Size Monthly.csv")
returns <- read.csv("Average Weighted Returns Monthly.csv")
```

The variables we plan to use in this dataset are: 
* Year
* Percent Return 
* Industry (the 49 individual industries as well as composite industries which we will create later during the data cleaning process)
* Average Firm Size - represented in millions of dollars (?)
* Book Equity / Market Equity - *describe the units and description here*

###Data Cleaning

First, across all datasets, when an observation has a firm size, percent return, or beta ratio of zero, the dataset reads -99.99. We will begin by transforming all of these values to zero. 
```{r}
#BE <- BE[complete.cases(BE),]
#size <- size[complete.cases(size),]
#returns <- returns[complete.cases(returns),]
BE[BE== -99.99] <- 0 
size[size == -99.99] <- 0 
returns[returns == -99.99] <- 0 

```

Next, we will reformat the monthly date variables in the Returns and Size dataframes. We will also find yearly averages for the returns and size dataframes to standardize all of them by year.
```{r}
# separate year from month in "size" dataframe
size$Year2 <- substr(size$Year, 1, 4)
size$Month <- substr(size$Year, 5, 6)

# separate year from month in "returns" dataframe
returns$Year2 <- substr(size$Year, 1, 4)
returns$Month <- substr(size$Year, 5, 6)

# make an average by year for "size" dataframe

table(size[size$Year2 == "1926",])


apply(size[size$Year2 == "1926",], 2, mean)
size[size$Year2 == "1926",]

data.frame(size[], apply(size[,c(2:50)],2, mean) )

table(size$Year2)
```


Transpose of data to get proper dataframe, etc - Run as loop; list that is part of the three dataframes - go through three dataframes and grab the information for the industry and use rbind - stack industries on top of each other and then make a column about what industry is it - make it after the fact. Couple of nested loops. We can turn year into a 20 year block and turn stuff into composite sectors 
```{r}
variables <- list("BE/ME", "Average Yearly Returns", "Firm Size")
for (i in 2:50){
  
}


```


Create the composite variables including industry, 20-year period, etc
```{r}

```



###Graphics 

First, we will use a boxplot between our composite industries to examine if there is an observable difference between our composite industries in terms of Beta values
```{r}
boxplot()
```





